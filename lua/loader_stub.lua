---@diagnostic disable: unbalanced-assignments, deprecated, undefined-global
local b,F,B = table -- table, wrap_state, bc_to_state
-- fione, in 8326 bytes, taken from https://gist.github.com/bainchild/df4f2d320f08c954c471aff1c9a79451
do local a=bit32 local c,d,e,f,g,h,i,j,k,l=b.create,b.unpack,b.pack,b.move,a.rshift,a.lshift,a.band,assert,nil,{[22]=18,[31]=8,[33]=28,[0]=3,[1]=13,[2]=23,[26]=33,[12]=1,[13]=6,[14]=10,[15]=16,[16]=20,[17]=26,[18]=30,[19]= 36,[3]=0,[4]=2,[5]=4,[6]=7,[7]=9,[8]=12,[9]=14,[10]=17,[20]=19,[21]=22,[23]=24,[ 24]=27,[25]=29,[27]=32,[32]=34,[34]=37,[11]=5,[28]=11,[29]=15,[30]=21,[35]=25,[ 36]=31,[37]=35}local m=function(m,n,o,p)local q=0 for r=n,o,p do local s=256^ math.abs(r-n)q=q+s*m:byte(r)end return q end local n=function(n,o,p,q)local r,s, t,u=(-1)^g(q,7),g(p,7)+h(i(q,0x7f),1),n+h(o,8)+h(i(p,0x7f),16),1 if s==0 then if t==0 then return r*0 else u=0 s=1 end elseif s==0x7f then if t==0 then return r* (1/0)else return r*(0/0)end end return r*2^(s-127)*(1+u/8388608)end local o= function(o,p,q,r,s,t,u,v)local w,x,y,z=(-1)^g(v,7),h(i(v,0x7f),4)+g(u,4),i(u,0xf )*281474976710656,1 y=y+(t*1099511627776)+(s*4294967296)+(r*16777216)+(q*65536)+ (p*256)+o if x==0 then if y==0 then return w*0 else z=0 x=1 end elseif x==0x7ff then if y==0 then return w*(1/0)else return w*(0/0)end end return w*2^(x-1023)*( z+y/4503599627370496)end local p={{function(p,q)return n(p:byte(q,q+3))end, function(p,q)local r,s,t,u=p:byte(q,q+3)return n(u,t,s,r)end},{function(p,q) return o(p:byte(q,q+7))end,function(p,q)local r,s,t,u,v,w,x,y=p:byte(q,q+7) return o(y,x,w,v,u,t,s,r)end}}local q=function(q)local r=q.index local s=q. source:byte(r)q.index=r+1 return s end local r=function(r,s)local t=r.index+s local u=r.source:sub(r.index,t-1)r.index=t return u end local s=function(s)local t,u=s:sz(),nil if t~=0 then u=r(s,t):sub(1,-2)end return u end local t=function( t,u)return function(v)local w=v.index+t local x=u(v.source,v.index,w)v.index=w return x end end local u=function(u,v)return function(w)local x=v(w.source,w. index)w.index=w.index+u return x end end local v=function(v)local w=v:si()local x=c(w)for y=1,w do local z=v:sn()local A=i(z,0x3f)local B,C,D=( 'CBCCCBCBCCCCCCCCCCCCCCsCCCCCCCCssCCCBC'):sub(A+1,A+1),( 'RNKNUURNUNKNRKKNUNKKUURKKKKKKKKKKKKKRNRNRNRRRNKKKKKKRURUUUUUUNRNRNNUUUNNUNUN' ):sub(A*2+1,A*2+2),{value=z,op=l[A],A=i(g(z,6),0xff)}if B=='C'then D.B=i(g(z,23) ,0x1ff)D.C=i(g(z,14),0x1ff)D.KB=C:byte(1)==75 and D.B>0xff D.KC=C:byte(2)==75 and D.C>0xff if A==10 then local E=i(g(D.B,3),31)if E==0 then D.co=D.B else D.co =h(i(D.B,7)+8,E-1)end end elseif B=='B'then D.Bx=i(g(z,14),0x3ffff)D.K=C:byte(1) ==75 elseif B=='s'then D.sBx=i(g(z,14),0x3ffff)-131071 end x[y]=D end return x end local w=function(w)local x=w:si()local y=c(x)for z=1,x do local A,B=q(w),nil if A==1 then B=q(w)~=0 elseif A==3 then B=w:s_num()elseif A==4 then B=s(w)end y[ z]=B end return y end local x=function(x)local y=x:si()local z=c(y)for A=1,y do z[A]=k(x)end return z end local y=function(y)local z=y:si()local A=c(z)for B=1,z do A[B]=y:si()end return A end local z=function(z)local A=z:si()local B=c(A)for C=1,A do B[C]={varname=s(z),startpc=z:si(),endpc=z:si()}end return B end local A =function(A)local B=A:si()local C=c(B)for D=1,B do C[D]=s(A)end return C end function k(B)local C,D={},s(B)C.source=D B:si()B:si()C.nuv=q(B)C.np=q(B)C.vararg =q(B)C.ms=q(B)C.code=v(B)C.co=w(B)C.subs=x(B)C.lines=y(B)z(B)A(B)C.needs_arg=i(C .vararg,0x5)==0x5 for E,F in ipairs(C.code)do if F.K then F.co=C.co[F.Bx+1]else if F.KB then F.co_B=C.co[F.B-0xff]end if F.KC then F.co_C=C.co[F.C-0xff]end end end return C end local B=function(B)local C={index=1,source=B}j(r(C,4)=='\27Lua' )j(q(C)==0x51)j(q(C)==0)local D=q(C)~=0 local E,F,G,H,I,J=D and function(E,F,G) return m(E,F,G-1,1)end or function(E,F,G)return m(E,G-1,F,-1)end,q(C),q(C),q(C), q(C),q(C)~=0 C.si=t(F,E)C.sz=t(G,E)C.sn=t(H,E)if J then C.s_num=t(I,E)elseif p[I /4]then C.s_num=u(I,p[I/4][D and 1 or 2])else error()end return k(C)end local C= function(C,D)for E,F in pairs(C)do if F.index>=D then F.value=F.store[F.index]F. store=F F.index='value'C[E]=nil end end end local D=function(D,E,F)local G=D[E] if not G then G={index=E,store=F}D[E]=G end return G end local E=function(E,F) local G,H=E.source,E.lines[E.pc-1]error(string.format('%s:%i: %s',G or'chunk',H or-1,F or'error'),0)end local F local G=function(G,H,I)local J,K,L,M,N,O,P=G. code,G.subs,G.vararg,-1,{},G.memory,G.pc while true do local Q=J[P]local R=Q.op P=P+1 if R<18 then if R<8 then if R<3 then if R<1 then for S=Q.A,Q.B do O[S]=nil end elseif R>1 then local S=I[Q.B]O[Q.A]=S.store[S.index]else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[Q.C]end O[Q.A]=S+T end elseif R>3 then if R<6 then if R>4 then local S,T,U=Q.A,Q.B,nil if Q.KC then U=Q.co_C else U=O[Q.C]end O[S+1]=O[T]O[S]=O[T][U]else O[Q.A]=H[Q.co]end elseif R >6 then local S if Q.KC then S=Q.co_C else S=O[Q.C]end O[Q.A]=O[Q.B][S]else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[ Q.C]end O[Q.A]=S-T end else O[Q.A]=O[Q.B]end elseif R>8 then if R<13 then if R< 10 then H[Q.co]=O[Q.A]elseif R>10 then if R<12 then local S,T,U,V=Q.A,Q.B,Q.C, nil if T==0 then V=M-S else V=T-1 end local W=e(O[S](d(O,S+1,S+V)))local X=W.n if U==0 then M=S+X-1 else X=U-1 end f(W,1,X,S,O)else local S=I[Q.B]S.store[S. index]=O[Q.A]end else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[Q.C]end O[Q.A]=S*T end elseif R>13 then if R<16 then if R >14 then local S,T,U=Q.A,Q.B,nil if T==0 then U=M-S else U=T-1 end C(N,0)return O[S](d(O,S+1,S+U))else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[Q.C]end O[Q.A][S]=T end elseif R>16 then O[Q.A]=c(Q.co) else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[Q.C]end O[Q.A]=S/T end else O[Q.A]=Q.co end else local S=Q.A local T=O[S+2] local U,V,W=O[S]+T,O[S+1],nil if T>=0 then W=U<=V else W=U>=V end if W then O[S] =U O[S+3]=U P=P+Q.sBx end end elseif R>18 then if R<28 then if R<23 then if R<20 then O[Q.A]=#O[Q.B]elseif R>20 then if R<22 then local S,T,U=Q.A,Q.B,nil if T==0 then U=M-S+1 else U=T-1 end C(N,0)return d(O,S,S+U-1)else local S,T=Q.B,Q.C local U,V=pcall(b.concat,O,'',S,T)if not U then V=O[S]for W=S+1,T do V=V..O[W] end end O[Q.A]=V end else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q. KC then T=Q.co_C else T=O[Q.C]end O[Q.A]=S%T end elseif R>23 then if R<26 then if R>24 then C(N,Q.A)else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q. KC then T=Q.co_C else T=O[Q.C]end if(S==T)==(Q.A~=0)then P=P+J[P].sBx end P=P+1 end elseif R>26 then local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[Q.C]end if(S<T)==(Q.A~=0)then P=P+J[P].sBx end P=P+1 else local S,T if Q.KB then S=Q.co_B else S=O[Q.B]end if Q.KC then T=Q.co_C else T=O[ Q.C]end O[Q.A]=S^T end else O[Q.A]=Q.B~=0 if Q.C~=0 then P=P+1 end end elseif R> 28 then if R<33 then if R<30 then local S,T if Q.KB then S=Q.co_B else S=O[Q.B] end if Q.KC then T=Q.co_C else T=O[Q.C]end if(S<=T)==(Q.A~=0)then P=P+J[P].sBx end P=P+1 elseif R>30 then if R<32 then local S=K[Q.Bx+1]local T,U=S.nuv,nil if T~=0 then U=c(T-1)for V=1,T do local W=J[P+V-1]if W.op==l[0]then U[V-1]=D(N,W.B, O)elseif W.op==l[4]then U[V-1]=I[W.B]end end P=P+T end O[Q.A]=F(S,H,U)else local S,T=Q.A,Q.B if(not O[T])~=(Q.C~=0)then O[S]=O[T]P=P+J[P].sBx end P=P+1 end else O[Q.A]=-O[Q.B]end elseif R>33 then if R<36 then if R>34 then local S,T=Q.A,Q.B if T==0 then T=L.len M=S+T-1 end f(L.list,1,T,S,O)else local S,T,U,V=Q.A,nil,nil ,nil T=j(tonumber(O[S]))U=j(tonumber(O[S+1]))V=j(tonumber(O[S+2]))O[S]=T-V O[S+1 ]=U O[S+2]=V P=P+Q.sBx end elseif R>36 then local S,T,U=Q.A,Q.C,Q.B local V,W=O[ S],nil if U==0 then U=M-S end if T==0 then T=Q[P].value P=P+1 end W=(T-1)*50 f(O ,S+1,S+U,W+1,V)else O[Q.A]=not O[Q.B]end else if(not O[Q.A])~=(Q.C~=0)then P=P+J [P].sBx end P=P+1 end else local S=Q.A local T,U=S+3,{O[S](O[S+1],O[S+2])}f(U,1, Q.C,T,O)if O[T]~=nil then O[S+2]=O[T]P=P+J[P].sBx end P=P+1 end else P=P+Q.sBx end G.pc=P end end function F(H,I,J)local K=function(...)local K,L,M=e(...),c(H. ms),{len=0,list={}}f(K,1,H.np,0,L)if H.np<K.n then local N,O=H.np+1,K.n-H.np M. len=O f(K,N,N+O-1,1,M.list)end if H.needs_arg then L[H.np]={n=M.len,d(M.list,1,M .len)}end local N={vararg=M,memory=L,code=H.code,subs=H.subs,pc=1}local O=e( pcall(G,N,I,J))if O[1]then return d(O,2,O.n)else local P={pc=N.pc,source=H. source,lines=H.lines}E(P,O[2])return end end return K end end
-- base64 decode, from http://lua-users.org/wiki/BaseSixtyFour
local b2='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
local function base64d(d)
   return (d:gsub('[^'..b2..'=]', ''):gsub('.', function(x)
      if (x == '=') then return '' end
      local r,f='',(b2:find(x)-1)
      for i=6,1,-1 do r=r..(f%2^i-f%2^(i-1)>0 and '1' or '0') end
      return r;
   end):gsub('%d%d%d?%d?%d?%d?%d?%d?', function(x)
      if (#x ~= 8) then return '' end
      local c=0
      for i=1,8 do c=c+(x:sub(i,i)=='1' and 2^(8-i) or 0) end
      return string.char(c)
   end))
end
pcall(function()
   local w = {}
   for _,v in next, game:GetService("TextService"):GetFamilyInfo("rbxasset://source.json").Faces do
      w[#w+1] = v.Name
   end
   F(B(base64d(table.concat(w,""))),{
      -- unfortunately, not a better way to do this without losing optimizations for everything (getfenv)
      -- I assume it only happens by calling them, though
      getfenv=getfenv,setfenv=setfenv,loadstring=loadstring,
      -- assert,error,getmetatable,ipairs,loadstring,newproxy,next,pairs,pcall,print,rawget,rawequal,rawlen,rawset,require,select,setmetatable,tonumber,tostring,type,unpack,xpcall,_G,_VERSION
      -- bit32,buffer,coroutine,debug,math,os,string,table,task,utf8,vector
      -- elapsedTime,PluginManager,settings,tick,time,typeof,UserSettings,version,warn,Enum,game,plugin,shared,script,workspace
      -- Axes,BrickColor,CFrame,Color3,Color3uint8,ColorSequence,Content,DateTime,Faces,FloatCurveKey,Font,NumberRange,NumberSequence,OverlapParams,PhysicalProperties,Ray,RaycastParams,RaycastResult,Rect,Region3,Region3int16,RotationCurveKey,TweenInfo,UDim,UDim2,Vector2,Vector3,Vector3int16
      assert=assert,error=error,getmetatable=getmetatable,ipairs=ipairs,newproxy=newproxy,next=next,pairs=pairs,pcall=pcall,print=print,rawget=rawget,rawequal=rawequal,rawlen=rawlen,rawset=rawset,require=require,select=select,setmetatable=setmetatable,tonumber=tonumber,tostring=tostring,type=type,unpack=unpack,xpcall=xpcall,_G=_G,_VERSION=_VERSION,bit32=bit32,buffer=buffer,coroutine=coroutine,debug=debug,math=math,os=os,string=string,table=table,task=task,utf8=utf8,vector=vector,elapsedTime=elapsedTime,PluginManager=PluginManager,settings=settings,tick=tick,time=time,typeof=typeof,UserSettings=UserSettings,version=version,warn=warn,Enum=Enum,game=game,plugin=plugin,shared=shared,script=script,workspace=workspace,Axes=Axes,BrickColor=BrickColor,CFrame=CFrame,Color3=Color3,Color3uint8=Color3uint8,ColorSequence=ColorSequence,Content=Content,DateTime=DateTime,Faces=Faces,FloatCurveKey=FloatCurveKey,Font=Font,NumberRange=NumberRange,NumberSequence=NumberSequence,OverlapParams=OverlapParams,PhysicalProperties=PhysicalProperties,Ray=Ray,RaycastParams=RaycastParams,RaycastResult=RaycastResult,Rect=Rect,Region3=Region3,Region3int16=Region3int16,RotationCurveKey=RotationCurveKey,TweenInfo=TweenInfo,UDim=UDim,UDim2=UDim2,Vector2=Vector2,Vector3=Vector3,Vector3int16=Vector3int16
   })(base64d) -- might as well pass it
end)
